#lang racket


(define (count-increases ip)
  (for/fold ((incr 0)
             (prev '())
             #:result incr)
            ((line (in-lines ip)))
    (let ((n (string->number line)))
      (cond ((null? prev) (values incr n))
            ((> n prev) (values (add1 incr) n))
            (else (values incr n))))))

(call-with-input-file "input.txt"
  count-increases)